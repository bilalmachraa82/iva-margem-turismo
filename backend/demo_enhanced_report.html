
        <!DOCTYPE html>
        <html lang="pt-PT">
        <head>
            <meta charset="UTF-8">
            <title>Relatório IVA sobre Margem - TurismoExcel - Agência de Viagens Lda</title>
            <style>
                @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

                * {
                    margin: 0;
                    padding: 0;
                    box-sizing: border-box;
                }

                body {
                    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                    line-height: 1.6;
                    color: #1f2937;
                    background-color: #ffffff;
                    -webkit-print-color-adjust: exact;
                    print-color-adjust: exact;
                }

                .container {
                    max-width: 1200px;
                    margin: 0 auto;
                    padding: 20px;
                }

                @media print {
                    .container {
                        max-width: 100%;
                        padding: 10px;
                    }
                    .no-print {
                        display: none !important;
                    }
                    .page-break {
                        page-break-after: always;
                    }
                    body {
                        font-size: 11pt;
                    }
                    .toc, .executive-summary {
                        page-break-after: always;
                    }
                }

                /* Table of Contents Styles */
                .toc {
                    background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
                    border: 2px solid #cbd5e1;
                    border-radius: 12px;
                    padding: 32px;
                    margin-bottom: 40px;
                    page-break-inside: avoid;
                }

                .toc h2 {
                    color: #1e40af;
                    font-size: 2em;
                    font-weight: 700;
                    margin-bottom: 24px;
                    text-align: center;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    gap: 12px;
                }

                .toc-list {
                    display: grid;
                    gap: 12px;
                    max-width: 800px;
                    margin: 0 auto;
                }

                .toc-item {
                    display: grid;
                    grid-template-columns: auto 1fr auto;
                    gap: 16px;
                    align-items: center;
                    padding: 12px 16px;
                    background: rgba(255, 255, 255, 0.8);
                    border-radius: 8px;
                    border-left: 4px solid;
                    transition: background 0.2s ease;
                }

                .toc-item.level-1 {
                    border-left-color: #1e40af;
                    font-weight: 600;
                    font-size: 1.1em;
                }

                .toc-item.level-2 {
                    border-left-color: #3b82f6;
                    margin-left: 20px;
                }

                .toc-item.level-3 {
                    border-left-color: #60a5fa;
                    margin-left: 40px;
                    font-size: 0.95em;
                }

                .toc-item:hover {
                    background: rgba(255, 255, 255, 1);
                    transform: translateX(4px);
                }

                .toc-number {
                    color: #1e40af;
                    font-weight: 700;
                    font-size: 0.9em;
                    min-width: 24px;
                }

                .toc-title {
                    color: #1f2937;
                }

                .toc-page {
                    color: #6b7280;
                    font-size: 0.9em;
                }

                .toc-link {
                    text-decoration: none;
                    color: inherit;
                    display: contents;
                }

                /* Executive Summary Styles */
                .executive-summary {
                    background: linear-gradient(135deg, #fefce8 0%, #fef3c7 100%);
                    border: 3px solid #f59e0b;
                    border-radius: 12px;
                    padding: 40px;
                    margin-bottom: 40px;
                    page-break-inside: avoid;
                }

                .executive-summary h2 {
                    color: #92400e;
                    font-size: 2.2em;
                    font-weight: 700;
                    margin-bottom: 24px;
                    text-align: center;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    gap: 12px;
                }

                .summary-grid {
                    display: grid;
                    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
                    gap: 24px;
                    margin-bottom: 32px;
                }

                .summary-card {
                    background: rgba(255, 255, 255, 0.9);
                    border-radius: 12px;
                    padding: 24px;
                    border-left: 6px solid;
                    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
                }

                .summary-card.primary {
                    border-left-color: #1e40af;
                }

                .summary-card.success {
                    border-left-color: #16a34a;
                }

                .summary-card.warning {
                    border-left-color: #f59e0b;
                }

                .summary-card.danger {
                    border-left-color: #dc2626;
                }

                .summary-card h4 {
                    margin-bottom: 12px;
                    font-size: 1.1em;
                    font-weight: 600;
                }

                .summary-value {
                    font-size: 2.2em;
                    font-weight: 700;
                    margin-bottom: 8px;
                    letter-spacing: -0.02em;
                }

                .summary-description {
                    color: #6b7280;
                    font-size: 0.9em;
                    line-height: 1.4;
                }

                .summary-highlights {
                    background: rgba(255, 255, 255, 0.9);
                    border-radius: 12px;
                    padding: 24px;
                    margin-top: 24px;
                }

                .summary-highlights h4 {
                    color: #92400e;
                    margin-bottom: 16px;
                    font-size: 1.2em;
                    font-weight: 600;
                }

                .highlight-list {
                    display: grid;
                    gap: 12px;
                }

                .highlight-item {
                    display: flex;
                    align-items: flex-start;
                    gap: 12px;
                    padding: 12px;
                    background: rgba(255, 255, 255, 0.7);
                    border-radius: 8px;
                    border-left: 3px solid #f59e0b;
                }

                .highlight-icon {
                    color: #f59e0b;
                    font-weight: 700;
                    min-width: 20px;
                }

                /* Call-out Boxes */
                .call-out {
                    padding: 20px;
                    border-radius: 12px;
                    margin: 20px 0;
                    border-left: 6px solid;
                    position: relative;
                    overflow: hidden;
                }

                .call-out::before {
                    content: '';
                    position: absolute;
                    top: 0;
                    right: 0;
                    bottom: 0;
                    width: 4px;
                    opacity: 0.3;
                }

                .call-out.critical {
                    background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
                    border-left-color: #dc2626;
                    color: #7f1d1d;
                }

                .call-out.critical::before {
                    background: #dc2626;
                }

                .call-out.success {
                    background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
                    border-left-color: #16a34a;
                    color: #14532d;
                }

                .call-out.success::before {
                    background: #16a34a;
                }

                .call-out.warning {
                    background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
                    border-left-color: #f59e0b;
                    color: #92400e;
                }

                .call-out.warning::before {
                    background: #f59e0b;
                }

                .call-out.info {
                    background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
                    border-left-color: #0ea5e9;
                    color: #0c4a6e;
                }

                .call-out.info::before {
                    background: #0ea5e9;
                }

                .call-out h4 {
                    font-weight: 700;
                    margin-bottom: 8px;
                    display: flex;
                    align-items: center;
                    gap: 8px;
                }

                .call-out-icon {
                    font-size: 1.2em;
                }

                /* Compliance Badge */
                .compliance-badge {
                    display: inline-flex;
                    align-items: center;
                    gap: 8px;
                    padding: 8px 16px;
                    background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%);
                    border: 2px solid #16a34a;
                    border-radius: 20px;
                    color: #14532d;
                    font-weight: 600;
                    font-size: 0.9em;
                    box-shadow: 0 2px 4px rgba(22, 163, 74, 0.2);
                }

                /* Status Indicators */
                .status-indicator {
                    display: inline-flex;
                    align-items: center;
                    gap: 6px;
                    padding: 6px 12px;
                    border-radius: 16px;
                    font-size: 0.85em;
                    font-weight: 600;
                    text-transform: uppercase;
                    letter-spacing: 0.05em;
                }

                .status-indicator.validated {
                    background: #dcfce7;
                    color: #16a34a;
                }

                .status-indicator.pending {
                    background: #fef3c7;
                    color: #d97706;
                }

                .status-indicator.critical {
                    background: #fecaca;
                    color: #dc2626;
                }

                /* Section Anchors */
                .section-anchor {
                    display: block;
                    position: relative;
                    top: -80px;
                    visibility: hidden;
                }

                /* Hierarchical Section Numbering */
                .section-number {
                    color: #1e40af;
                    font-weight: 700;
                    margin-right: 12px;
                }

                /* Enhanced Section Headers */
                .section-header {
                    display: flex;
                    align-items: center;
                    gap: 16px;
                    margin-bottom: 24px;
                    padding-bottom: 12px;
                    border-bottom: 3px solid #e5e7eb;
                }

                .section-icon {
                    width: 48px;
                    height: 48px;
                    border-radius: 12px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 24px;
                    color: white;
                }

                /* Bookmarks for PDF */
                .bookmark {
                    position: absolute;
                    left: -9999px;
                    visibility: hidden;
                }

                /* Key Metrics Highlight */
                .key-metrics-highlight {
                    background: linear-gradient(135deg, #f0f9ff 0%, #dbeafe 100%);
                    border: 3px solid #2563eb;
                    border-radius: 16px;
                    padding: 32px;
                    margin: 32px 0;
                    text-align: center;
                }

                .key-metrics-highlight h3 {
                    color: #1e40af;
                    font-size: 1.8em;
                    font-weight: 700;
                    margin-bottom: 20px;
                }

                .metrics-grid {
                    display: grid;
                    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                    gap: 24px;
                    margin-top: 24px;
                }

                .metric-highlight {
                    background: rgba(255, 255, 255, 0.9);
                    padding: 20px;
                    border-radius: 12px;
                    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
                }

                .metric-highlight .value {
                    font-size: 2em;
                    font-weight: 700;
                    margin-bottom: 4px;
                }

                .metric-highlight .label {
                    color: #6b7280;
                    font-size: 0.9em;
                    font-weight: 500;
                }

                /* Legal Document Header */
                .legal-header {
                    background: linear-gradient(135deg, #0f766e 0%, #0f766e 100%);
                    color: white;
                    padding: 30px;
                    border-radius: 12px;
                    margin-bottom: 30px;
                    page-break-inside: avoid;
                }

                .company-info {
                    display: grid;
                    grid-template-columns: 2fr 1fr;
                    gap: 30px;
                    align-items: start;
                }

                .company-details h1 {
                    font-size: 2.2em;
                    font-weight: 700;
                    margin-bottom: 8px;
                }

                .company-details .subtitle {
                    font-size: 1.1em;
                    opacity: 0.9;
                    margin-bottom: 20px;
                }

                .company-meta {
                    display: grid;
                    grid-template-columns: auto 1fr;
                    gap: 8px 16px;
                    font-size: 0.95em;
                }

                .company-meta strong {
                    opacity: 0.8;
                }

                .report-meta {
                    text-align: right;
                    background: rgba(255,255,255,0.1);
                    padding: 20px;
                    border-radius: 8px;
                }

                .report-meta .big-number {
                    font-size: 2em;
                    font-weight: 700;
                    margin: 8px 0;
                }

                /* Legal Compliance Section */
                .legal-compliance {
                    background: linear-gradient(135deg, #fefce8 0%, #fef3c7 100%);
                    border: 2px solid #d97706;
                    border-radius: 12px;
                    padding: 30px;
                    margin-bottom: 30px;
                    page-break-inside: avoid;
                }

                .legal-compliance h2 {
                    color: #92400e;
                    margin-bottom: 20px;
                    font-size: 1.5em;
                    display: flex;
                    align-items: center;
                    gap: 12px;
                }

                .disclaimers {
                    display: grid;
                    gap: 16px;
                    margin-bottom: 24px;
                }

                .disclaimer {
                    background: rgba(255,255,255,0.7);
                    padding: 16px;
                    border-radius: 8px;
                    border-left: 4px solid #d97706;
                }

                .disclaimer h4 {
                    color: #92400e;
                    margin-bottom: 8px;
                    font-size: 1em;
                }

                .disclaimer p {
                    color: #78350f;
                    font-size: 0.9em;
                    line-height: 1.5;
                }

                /* Professional Validation Section */
                .validation-section {
                    background: #f8fafc;
                    border: 2px solid #cbd5e1;
                    border-radius: 12px;
                    padding: 30px;
                    margin: 30px 0;
                    page-break-inside: avoid;
                }

                .validation-grid {
                    display: grid;
                    grid-template-columns: 1fr 1fr;
                    gap: 30px;
                    margin-top: 20px;
                }

                .validation-box {
                    background: white;
                    border: 2px dashed #cbd5e1;
                    border-radius: 8px;
                    padding: 24px;
                    text-align: center;
                    min-height: 120px;
                    display: flex;
                    flex-direction: column;
                    justify-content: space-between;
                }

                .validation-box h4 {
                    color: #475569;
                    margin-bottom: 12px;
                }

                .signature-line {
                    border-bottom: 2px solid #cbd5e1;
                    margin: 20px 0 8px 0;
                    height: 30px;
                }

                .checklist {
                    background: white;
                    border-radius: 8px;
                    padding: 20px;
                    margin-top: 20px;
                }

                .checklist h4 {
                    color: #475569;
                    margin-bottom: 16px;
                    display: flex;
                    align-items: center;
                    gap: 8px;
                }

                .checklist-items {
                    display: grid;
                    gap: 12px;
                }

                .checklist-item {
                    display: grid;
                    grid-template-columns: 30px 1fr auto;
                    gap: 12px;
                    align-items: center;
                    padding: 8px;
                    border-radius: 4px;
                    transition: background 0.2s ease;
                }

                .checklist-item:hover {
                    background: #f1f5f9;
                }

                .checkbox {
                    width: 20px;
                    height: 20px;
                    border: 2px solid #cbd5e1;
                    border-radius: 4px;
                    justify-self: center;
                }

                /* Traceability Section */
                .traceability {
                    background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
                    border: 1px solid #0ea5e9;
                    border-radius: 12px;
                    padding: 24px;
                    margin-bottom: 30px;
                    font-family: 'Courier New', monospace;
                }

                .traceability h3 {
                    color: #0369a1;
                    margin-bottom: 16px;
                    font-family: 'Inter', sans-serif;
                }

                .trace-grid {
                    display: grid;
                    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                    gap: 16px;
                }

                .trace-item {
                    background: rgba(255,255,255,0.8);
                    padding: 12px;
                    border-radius: 6px;
                    font-size: 0.85em;
                }

                .trace-item strong {
                    color: #0369a1;
                    display: block;
                    margin-bottom: 4px;
                    font-family: 'Inter', sans-serif;
                }

                /* Header Styles */
                .header {
                    text-align: center;
                    padding: 40px 0;
                    background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
                    color: white;
                    border-radius: 12px;
                    margin-bottom: 40px;
                }

                .header h1 {
                    font-size: 2.5em;
                    font-weight: 700;
                    margin-bottom: 10px;
                    letter-spacing: -0.02em;
                }

                .header .subtitle {
                    font-size: 1.1em;
                    opacity: 0.9;
                    font-weight: 300;
                }

                /* Key Metrics Dashboard */
                .metrics-dashboard {
                    display: grid;
                    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                    gap: 20px;
                    margin-bottom: 40px;
                }

                .metric-card {
                    background: white;
                    border: 1px solid #e5e7eb;
                    border-radius: 12px;
                    padding: 24px;
                    text-align: center;
                    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
                    transition: transform 0.2s ease;
                }

                .metric-card:hover {
                    transform: translateY(-2px);
                    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
                }

                .metric-card .icon {
                    width: 48px;
                    height: 48px;
                    margin: 0 auto 12px;
                    border-radius: 12px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 24px;
                }

                .metric-card .value {
                    font-size: 2em;
                    font-weight: 700;
                    margin-bottom: 4px;
                    letter-spacing: -0.02em;
                }

                .metric-card .label {
                    font-size: 0.9em;
                    color: #6b7280;
                    font-weight: 500;
                }

                .metric-card .change {
                    font-size: 0.85em;
                    margin-top: 8px;
                    font-weight: 600;
                }

                /* Section Styles */
                .section {
                    background: white;
                    border-radius: 12px;
                    padding: 32px;
                    margin-bottom: 32px;
                    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
                }

                .section-title {
                    font-size: 1.75em;
                    font-weight: 700;
                    margin-bottom: 24px;
                    color: #1f2937;
                    display: flex;
                    align-items: center;
                    gap: 12px;
                }

                .section-title::before {
                    content: '';
                    width: 4px;
                    height: 24px;
                    background: #3b82f6;
                    border-radius: 2px;
                }

                /* Chart Containers */
                .chart-container {
                    background: #f9fafb;
                    border-radius: 12px;
                    padding: 24px;
                    margin-bottom: 24px;
                    text-align: center;
                }

                .chart-grid {
                    display: grid;
                    grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
                    gap: 24px;
                }

                /* Tables */
                .data-table {
                    width: 100%;
                    border-collapse: separate;
                    border-spacing: 0;
                    margin-top: 20px;
                    font-size: 0.9em;
                }

                .data-table th {
                    background: #f3f4f6;
                    padding: 12px 16px;
                    text-align: left;
                    font-weight: 600;
                    color: #374151;
                    border-bottom: 2px solid #e5e7eb;
                }

                .data-table td {
                    padding: 12px 16px;
                    border-bottom: 1px solid #f3f4f6;
                }

                .data-table tr:hover {
                    background: #f9fafb;
                }

                .data-table .value {
                    text-align: right;
                    font-weight: 500;
                }

                /* Highlights */
                .highlight-box {
                    background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
                    border: 1px solid #86efac;
                    border-radius: 12px;
                    padding: 24px;
                    margin: 24px 0;
                }

                .highlight-box h3 {
                    color: #16a34a;
                    margin-bottom: 12px;
                    font-size: 1.3em;
                }

                /* Print Button */
                .print-btn {
                    position: fixed;
                    bottom: 30px;
                    right: 30px;
                    background: #3b82f6;
                    color: white;
                    border: none;
                    padding: 12px 24px;
                    border-radius: 8px;
                    font-weight: 600;
                    cursor: pointer;
                    box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
                    transition: all 0.2s ease;
                    z-index: 1000;
                }

                .print-btn:hover {
                    background: #2563eb;
                    transform: translateY(-2px);
                    box-shadow: 0 6px 20px rgba(59, 130, 246, 0.4);
                }

                /* Professional touches */
                .badge {
                    display: inline-block;
                    padding: 4px 12px;
                    border-radius: 20px;
                    font-size: 0.85em;
                    font-weight: 600;
                }

                .badge-success {
                    background: #dcfce7;
                    color: #16a34a;
                }

                .badge-info {
                    background: #dbeafe;
                    color: #2563eb;
                }

                .badge-warning {
                    background: #fef3c7;
                    color: #d97706;
                }
            </style>
        </head>
        <body>
            <button class="print-btn no-print" onclick="window.print()">
                🖨️ Imprimir / Guardar PDF
            </button>

            <div class="container">
                <!-- Table of Contents -->
                <div class="toc">
                    <div class="bookmark" id="toc">Índice</div>
                    <h2>📋 Índice</h2>
                    <div class="toc-list">
                        <a href="#executive-summary" class="toc-link">
                            <div class="toc-item level-1">
                                <span class="toc-number">1.</span>
                                <span class="toc-title">Sumário Executivo</span>
                                <span class="toc-page">p. 2</span>
                            </div>
                        </a>

                        <a href="#legal-header" class="toc-link">
                            <div class="toc-item level-1">
                                <span class="toc-number">2.</span>
                                <span class="toc-title">Identificação da Empresa</span>
                                <span class="toc-page">p. 3</span>
                            </div>
                        </a>

                        <a href="#legal-compliance" class="toc-link">
                            <div class="toc-item level-1">
                                <span class="toc-number">3.</span>
                                <span class="toc-title">Conformidade Legal e Disclaimers</span>
                                <span class="toc-page">p. 4</span>
                            </div>
                        </a>

                        <a href="#validation-section" class="toc-link">
                            <div class="toc-item level-2">
                                <span class="toc-number">3.1</span>
                                <span class="toc-title">Validação Profissional</span>
                                <span class="toc-page">p. 5</span>
                            </div>
                        </a>

                        <a href="#traceability" class="toc-link">
                            <div class="toc-item level-2">
                                <span class="toc-number">3.2</span>
                                <span class="toc-title">Sistema de Rastreabilidade</span>
                                <span class="toc-page">p. 6</span>
                            </div>
                        </a>

                        <a href="#key-metrics" class="toc-link">
                            <div class="toc-item level-1">
                                <span class="toc-number">4.</span>
                                <span class="toc-title">Indicadores Chave de Performance</span>
                                <span class="toc-page">p. 7</span>
                            </div>
                        </a>

                        <a href="#period-calculation" class="toc-link"><div class="toc-item level-1"><span class="toc-number">5.</span><span class="toc-title">Cálculo por Período Fiscal</span><span class="toc-page">p. 8</span></div></a>

                        <a href="#financial-analysis" class="toc-link">
                            <div class="toc-item level-1">
                                <span class="toc-number">6.</span>
                                <span class="toc-title">Análise Financeira Completa</span>
                                <span class="toc-page">p. 9</span>
                            </div>
                        </a>

                        <a href="#comparison-analysis" class="toc-link">
                            <div class="toc-item level-1">
                                <span class="toc-number">7.</span>
                                <span class="toc-title">Comparação de Regimes Fiscais</span>
                                <span class="toc-page">p. 10</span>
                            </div>
                        </a>

                        <a href="#savings-analysis" class="toc-link">
                            <div class="toc-item level-1">
                                <span class="toc-number">8.</span>
                                <span class="toc-title">Análise de Poupança Fiscal</span>
                                <span class="toc-page">p. 11</span>
                            </div>
                        </a>

                        <a href="#detailed-results" class="toc-link">
                            <div class="toc-item level-1">
                                <span class="toc-number">9.</span>
                                <span class="toc-title">Análise Detalhada por Documento</span>
                                <span class="toc-page">p. 12</span>
                            </div>
                        </a>
                    </div>
                </div>

                <!-- Executive Summary -->
                <div class="executive-summary">
                    <div class="bookmark" id="executive-summary">Sumário Executivo</div>
                    <div class="section-anchor" id="executive-summary"></div>
                    <h2>📊 Sumário Executivo</h2>

                    <div class="summary-grid">
                        <div class="summary-card primary">
                            <h4>🏢 Volume Total de Negócios</h4>
                            <div class="summary-value" style="color: #1e40af;">€4,300.00</div>
                            <div class="summary-description">
                                Faturação total processada no período de análise, base para cálculo do IVA sobre margem.
                            </div>
                        </div>

                        <div class="summary-card success">
                            <h4>💰 Margem Compensada Total</h4>
                            <div class="summary-value" style="color: #16a34a;">€1,150.00</div>
                            <div class="summary-description">
                                Margem após compensação de períodos anteriores - base tributável IVA.
                            </div>
                        </div>

                        <div class="summary-card warning">
                            <h4>💶 IVA a Pagar (23%)</h4>
                            <div class="summary-value" style="color: #f59e0b;">€299.00</div>
                            <div class="summary-description">
                                Montante de IVA calculado sobre a margem, conforme Artigo 308º do CIVA.
                            </div>
                        </div>

                        <div class="summary-card success">
                            <h4>📈 Poupança Fiscal</h4>
                            <div class="summary-value" style="color: #16a34a;">€690.00</div>
                            <div class="summary-description">
                                Economia obtida com regime de margem vs. regime normal de IVA.
                            </div>
                        </div>

                        <div class="summary-card primary">
                            <h4>📊 Taxa de Margem</h4>
                            <div class="summary-value" style="color: #1e40af;">30.2%</div>
                            <div class="summary-description">
                                Percentual de margem sobre o volume total de vendas processado.
                            </div>
                        </div>

                        <div class="summary-card danger">
                            <h4>📋 Documentos Processados</h4>
                            <div class="summary-value" style="color: #dc2626;">4</div>
                            <div class="summary-description">
                                2 vendas + 2 custos analisados e associados.
                            </div>
                        </div>
                    </div>

                    <div class="summary-highlights">
                        <h4>🎯 Principais Conclusões</h4>
                        <div class="highlight-list">
                            <div class="highlight-item">
                                <span class="highlight-icon">✅</span>
                                <span>
                                    <strong>Regime de Margem Aplicável:</strong> A empresa está enquadrada no regime especial de tributação da margem (Art. 308º CIVA),
                                    permitindo significativa otimização fiscal.
                                </span>
                            </div>

                            <div class="highlight-item">
                                <span class="highlight-icon">💰</span>
                                <span>
                                    <strong>Poupança de 69.8%:</strong>
                                    Em comparação com o regime normal, a empresa economiza €690.00
                                    em IVA no período analisado.
                                </span>
                            </div>

                            <div class="highlight-item">
                                <span class="highlight-icon">⚖️</span>
                                <span>
                                    <strong>Conformidade Legal:</strong> Todos os cálculos seguem rigorosamente as disposições legais e orientações da AT
                                    para o setor do turismo.
                                </span>
                            </div>

                            <div class='highlight-item'><span class='highlight-icon'>📅</span><span><strong>Compensação Períodos Anteriores:</strong> Margem negativa de €150.00 foi adequadamente compensada, restando €50.00 para transportar.</span></div>

                            <div class="highlight-item">
                                <span class="highlight-icon">📊</span>
                                <span>
                                    <strong>Margem Saudável:</strong> Taxa de margem de 30.2% indica operação sustentável
                                    acima da média do setor.
                                </span>
                            </div>

                            <div class="highlight-item">
                                <span class="highlight-icon">🔍</span>
                                <span>
                                    <strong>Validação Necessária:</strong> Este relatório requer validação por ROC/TOC habilitado
                                    antes da submissão às autoridades fiscais.
                                </span>
                            </div>
                        </div>
                    </div>

                    <div class="call-out critical">
                        <h4><span class="call-out-icon">⚠️</span> Ação Requerida</h4>
                        <p>
                            <strong>Validação Profissional Obrigatória:</strong> Este documento tem caráter informativo.
                            É obrigatória a validação por Revisor Oficial de Contas (ROC) ou Técnico Oficial de Contas (TOC)
                            antes de qualquer submissão fiscal oficial.
                        </p>
                    </div>

                    <div style="text-align: center; margin-top: 24px;">
                        <span class="compliance-badge">
                            ✅ Conforme Art. 308º CIVA
                        </span>
                        <span class="status-indicator validated" style="margin-left: 16px;">
                            📋 Documentação Completa
                        </span>
                        <span class="status-indicator pending" style="margin-left: 16px;">
                            👤 Validação ROC/TOC Pendente
                        </span>
                    </div>
                </div>

                <!-- Legal Document Header -->
                <div class="legal-header">
                    <div class="bookmark" id="legal-header">Identificação da Empresa</div>
                    <div class="section-anchor" id="legal-header"></div>
                    <div class="company-info">
                        <div class="company-details">
                            <h1>Relatório IVA sobre Margem</h1>
                            <p class="subtitle">Regime Especial de Tributação - Artigo 308º do CIVA</p>

                            <div class="company-meta">
                                <strong>Empresa:</strong>
                                <span>TurismoExcel - Agência de Viagens Lda</span>
                                <strong>NIF:</strong>
                                <span>123456789</span>
                                <strong>CAE:</strong>
                                <span>79110 - Agências de viagem</span>
                                <strong>Período Fiscal:</strong>
                                <span>2025-01-01 - 2025-03-31</span>
                            </div>
                        </div>

                        <div class="report-meta">
                            <div style="font-size: 0.9em; opacity: 0.8; margin-bottom: 8px;">Relatório Nº</div>
                            <div class="big-number">8D11DAF7</div>
                            <div style="font-size: 0.85em; opacity: 0.8; margin-top: 8px;">
                                16/09/2025 às 12:56
                            </div>
                            <div style='font-size: 0.8em; opacity: 0.7; margin-top: 12px;'>Hash SAF-T:<br>1a2b3c4d5e6f7890...</div>
                        </div>
                    </div>
                </div>

                <!-- Legal Compliance and Disclaimers -->
                <div class="legal-compliance">
                    <div class="bookmark" id="legal-compliance">Conformidade Legal</div>
                    <div class="section-anchor" id="legal-compliance"></div>
                    <h2>⚖️ Conformidade Legal e Disclaimers Obrigatórios</h2>

                    <div class="disclaimers">
                        <div class="disclaimer">
                            <h4>📋 Artigo 308º do CIVA - Regime de Tributação da Margem</h4>
                            <p>Este relatório foi elaborado com base no regime especial de tributação sobre a margem, aplicável a agências de viagem e operadores turísticos, conforme previsto no Artigo 308º do Código do IVA. O IVA incide apenas sobre a margem de lucro das operações.</p>
                        </div>

                        <div class="disclaimer">
                            <h4>🗄️ SAF-T e Portaria 302/2016</h4>
                            <p>Os dados utilizados neste relatório foram extraídos do ficheiro SAF-T (Standard Audit File for Tax) em conformidade com a Portaria n.º 302/2016. A integridade dos dados foi verificada mediante hash SHA-256.</p>
                        </div>

                        <div class="disclaimer">
                            <h4>ℹ️ Caráter Informativo</h4>
                            <p>Este documento tem caráter puramente informativo e não substitui a declaração oficial de IVA. Os cálculos apresentados devem ser validados pelo contabilista certificado ou ROC da empresa antes da submissão às autoridades fiscais.</p>
                        </div>

                        <div class="disclaimer">
                            <h4>✅ Validação Profissional Obrigatória</h4>
                            <p>É obrigatória a validação por Revisor Oficial de Contas (ROC) ou Técnico Oficial de Contas (TOC) habilitado. Este relatório não substitui o parecer técnico profissional nem a responsabilidade fiscal da empresa.</p>
                        </div>
                    </div>
                </div>

                <!-- Professional Validation Section -->
                <div class="validation-section">
                    <div class="bookmark" id="validation-section">Validação Profissional</div>
                    <div class="section-anchor" id="validation-section"></div>
                    <h2 style="color: #475569; margin-bottom: 20px; display: flex; align-items: center; gap: 12px;">
                        👥 Validação e Certificação Profissional
                    </h2>

                    <div class="validation-grid">
                        <div class="validation-box">
                            <div>
                                <h4>ROC/TOC Responsável</h4>
                                <p style="font-size: 0.85em; color: #6b7280; margin: 8px 0;">Nome completo e número de inscrição</p>
                                <div class="signature-line"></div>
                                <p style="font-size: 0.8em; color: #6b7280;">Assinatura e Data</p>
                            </div>
                            <div style="margin-top: 16px; padding: 8px; border: 2px dashed #cbd5e1; border-radius: 4px; text-align: center; color: #6b7280; font-size: 0.8em;">
                                Espaço para Carimbo Oficial
                            </div>
                        </div>

                        <div class="validation-box">
                            <div>
                                <h4>Representante da Empresa</h4>
                                <p style="font-size: 0.85em; color: #6b7280; margin: 8px 0;">Gerente ou administrador autorizado</p>
                                <div class="signature-line"></div>
                                <p style="font-size: 0.8em; color: #6b7280;">Assinatura e Data</p>
                            </div>
                            <div style="margin-top: 16px; padding: 8px; border: 2px dashed #cbd5e1; border-radius: 4px; text-align: center; color: #6b7280; font-size: 0.8em;">
                                Espaço para Carimbo da Empresa
                            </div>
                        </div>
                    </div>

                    <div class="checklist">
                        <h4>📋 Checklist de Conformidade</h4>
                        <div class="checklist-items">
                            <div class="checklist-item">
                                <div class="checkbox"></div>
                                <span>Verificação da aplicabilidade do Art. 308º do CIVA</span>
                                <span style="font-size: 0.8em; color: #6b7280;">ROC/TOC</span>
                            </div>
                            <div class="checklist-item">
                                <div class="checkbox"></div>
                                <span>Validação da integridade do ficheiro SAF-T</span>
                                <span style="font-size: 0.8em; color: #6b7280;">ROC/TOC</span>
                            </div>
                            <div class="checklist-item">
                                <div class="checkbox"></div>
                                <span>Conferência dos cálculos de margem</span>
                                <span style="font-size: 0.8em; color: #6b7280;">ROC/TOC</span>
                            </div>
                            <div class="checklist-item">
                                <div class="checkbox"></div>
                                <span>Verificação das associações vendas-custos</span>
                                <span style="font-size: 0.8em; color: #6b7280;">Empresa</span>
                            </div>
                            <div class="checklist-item">
                                <div class="checkbox"></div>
                                <span>Revisão dos documentos fonte</span>
                                <span style="font-size: 0.8em; color: #6b7280;">Empresa</span>
                            </div>
                            <div class="checklist-item">
                                <div class="checkbox"></div>
                                <span>Aprovação para submissão fiscal</span>
                                <span style="font-size: 0.8em; color: #6b7280;">ROC/TOC</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Traceability Section -->
                <div class="traceability">
                    <div class="bookmark" id="traceability">Sistema de Rastreabilidade</div>
                    <div class="section-anchor" id="traceability"></div>
                    <h3>🔍 Sistema de Rastreabilidade</h3>
                    <div class="trace-grid">
                        <div class="trace-item">
                            <strong>Hash do Relatório (SHA-256):</strong>
                            <span id="reportHash">Será calculado após geração</span>
                        </div>
                        <div class="trace-item">
                            <strong>Timestamp ISO 8601:</strong>
                            2025-09-16T12:56:28.872974
                        </div>
                        <div class="trace-item">
                            <strong>Versão do Sistema:</strong>
                            IVA Margem Pro v1.2.5
                        </div>
                        <div class="trace-item">
                            <strong>Origem dos Dados:</strong>
                            SAF-T (Hash: 1a2b3c4d5e6f7890...)
                        </div>
                        <div class="trace-item">
                            <strong>ID da Sessão:</strong>
                            demo-12345
                        </div>
                        <div class="trace-item">
                            <strong>Total de Documentos:</strong>
                            2 vendas + 2 custos
                        </div>
                    </div>
                </div>

                <!-- Key Metrics Dashboard -->
                <div class="key-metrics-highlight">
                    <div class="bookmark" id="key-metrics">Indicadores Chave</div>
                    <div class="section-anchor" id="key-metrics"></div>
                    <h3>📈 Indicadores Chave de Performance</h3>
                    <div class="metrics-grid">
                        <div class="metric-highlight">
                            <div class="value" style="color: #16a34a;">€299.00</div>
                            <div class="label">IVA a Pagar</div>
                        </div>
                        <div class="metric-highlight">
                            <div class="value" style="color: #1e40af;">30.2%</div>
                            <div class="label">Taxa de Margem</div>
                        </div>
                        <div class="metric-highlight">
                            <div class="value" style="color: #16a34a;">€690.00</div>
                            <div class="label">Poupança Total</div>
                        </div>
                        <div class="metric-highlight">
                            <div class="value" style="color: #2563eb;">4</div>
                            <div class="label">Docs Processados</div>
                        </div>
                    </div>
                </div>

                <div class="metrics-dashboard">
                    <div class="metric-card">
                        <div class="icon" style="background: #dcfce7;">📄</div>
                        <div class="value">2</div>
                        <div class="label">Documentos de Venda</div>
                        <div class="change" style="color: #16a34a;">Processados</div>
                    </div>

                    <div class="metric-card">
                        <div class="icon" style="background: #fee2e2;">📋</div>
                        <div class="value">2</div>
                        <div class="label">Documentos de Custo</div>
                        <div class="change" style="color: #dc2626;">Importados</div>
                    </div>

                    <div class="metric-card">
                        <div class="icon" style="background: #dbeafe;">💰</div>
                        <div class="value">€4,300.00</div>
                        <div class="label">Volume Total de Vendas</div>
                        <div class="change" style="color: #2563eb;">+IVA incluído</div>
                    </div>

                    <div class="metric-card">
                        <div class="icon" style="background: #e9d5ff;">📊</div>
                        <div class="value">30.2%</div>
                        <div class="label">Margem sobre Vendas</div>
                        <div class="change" style="color: #7c3aed;">Taxa de lucro</div>
                    </div>

                    <div class="metric-card">
                        <div class="icon" style="background: #dcfce7;">💶</div>
                        <div class="value">€299.00</div>
                        <div class="label">IVA a Pagar</div>
                        <div class="change" style="color: #16a34a;">Regime margem</div>
                    </div>
                </div>
                
                <div class="section" style="background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); border: 2px solid #0ea5e9;">
                    <div class="bookmark" id="period-calculation">Cálculo por Período</div>
                    <div class="section-anchor" id="period-calculation"></div>
                    <div class="section-header">
                        <div class="section-icon" style="background: #0ea5e9;">📅</div>
                        <div>
                            <span class="section-number">5.</span>
                            <h2 class="section-title" style="color: #0369a1; margin: 0;">Cálculo por Período Fiscal</h2>
                        </div>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                        <div style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                            <div style="font-size: 0.9em; color: #6b7280; margin-bottom: 8px;">Período de Análise</div>
                            <div style="font-size: 1.3em; font-weight: 700; color: #0369a1;">
                                2025-01-01 a 2025-03-31
                            </div>
                            <div style='font-size: 0.85em; color: #0891b2; margin-top: 4px;'>Trimestre 1/2025</div>
                        </div>

                        <div style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                            <div style="font-size: 0.9em; color: #6b7280; margin-bottom: 8px;">Margem Bruta do Período</div>
                            <div style="font-size: 1.5em; font-weight: 700; color: #16a34a;">
                                €1,300.00
                            </div>
                            <div style="font-size: 0.85em; color: #6b7280; margin-top: 4px;">
                                Vendas - Custos
                            </div>
                        </div>

                        <div style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                            <div style="font-size: 0.9em; color: #6b7280; margin-bottom: 8px;">(-) Margem Negativa Anterior</div>
                            <div style="font-size: 1.5em; font-weight: 700; color: #dc2626;">
                                €150.00
                            </div>
                            <div style="font-size: 0.85em; color: #6b7280; margin-top: 4px;">
                                Compensação períodos anteriores
                            </div>
                        </div>

                        <div style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                            <div style="font-size: 0.9em; color: #6b7280; margin-bottom: 8px;">(=) Margem Compensada</div>
                            <div style="font-size: 1.5em; font-weight: 700; color: #16a34a;">
                                €1,150.00
                            </div>
                            <div style="font-size: 0.85em; color: #6b7280; margin-top: 4px;">
                                Base tributável após compensação
                            </div>
                        </div>

                        <div style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                            <div style="font-size: 0.9em; color: #6b7280; margin-bottom: 8px;">IVA a Pagar (23%)</div>
                            <div style="font-size: 1.5em; font-weight: 700; color: #7c3aed;">
                                €299.00
                            </div>
                            <div style="font-size: 0.85em; color: #6b7280; margin-top: 4px;">
                                Sobre margem positiva
                            </div>
                        </div>

                        <div style="background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                            <div style="font-size: 0.9em; color: #6b7280; margin-bottom: 8px;">Margem a Transportar</div>
                            <div style="font-size: 1.5em; font-weight: 700; color: #dc2626;">
                                €50.00
                            </div>
                            <div style="font-size: 0.85em; color: #6b7280; margin-top: 4px;">
                                Para próximo período
                            </div>
                        </div>
                    </div>

                    <div style="margin-top: 24px; padding: 16px; background: #fef3c7; border-radius: 8px; border-left: 4px solid #f59e0b;">
                        <h4 style="margin: 0 0 8px 0; color: #92400e;">⚖️ Conformidade Legal</h4>
                        <p style="margin: 0; color: #78350f; font-size: 0.9em;">
                            Cálculo realizado conforme <strong>Artigo 308º do CIVA</strong> - Regime especial de tributação da margem.<br>
                            A compensação de margens negativas entre períodos está em conformidade com as orientações da AT.
                        </p>
                    </div>
                </div>
                
                <!-- Main Analysis Section -->
                <div class="section">
                    <div class="bookmark" id="financial-analysis">Análise Financeira</div>
                    <div class="section-anchor" id="financial-analysis"></div>
                    <div class="section-header">
                        <div class="section-icon" style="background: #1e40af;">📊</div>
                        <div>
                            <span class="section-number">6.</span>
                            <h2 class="section-title" style="margin: 0;">Análise Financeira Completa</h2>
                        </div>
                    </div>
                    <div class="chart-container">
                        <svg width="800" height="500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 500">
            <defs>
                <filter id="shadow" x="-50%" y="-50%" width="200%" height="200%">
                    <feGaussianBlur in="SourceAlpha" stdDeviation="3"/>
                    <feOffset dx="0" dy="2" result="offsetblur"/>
                    <feComponentTransfer>
                        <feFuncA type="linear" slope="0.2"/>
                    </feComponentTransfer>
                    <feMerge>
                        <feMergeNode/>
                        <feMergeNode in="SourceGraphic"/>
                    </feMerge>
                </filter>
                <linearGradient id="gridGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                    <stop offset="0%" style="stop-color:#f3f4f6;stop-opacity:0.5" />
                    <stop offset="100%" style="stop-color:#f3f4f6;stop-opacity:0" />
                </linearGradient>
            </defs>

            <!-- Background -->
            <rect width="800" height="500" fill="white"/>
            <rect x="80" y="60" width="680" height="360" fill="url(#gridGradient)" opacity="0.5"/>

            <!-- Title -->
            <text x="400.0" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#1f2937">Análise Financeira Completa</text>

            <!-- Grid lines -->
            <g stroke="#f3f4f6" stroke-width="1" stroke-dasharray="3,3">
        <line x1="80" y1="420.0" x2="760" y2="420.0"/><text x="70" y="425.0" text-anchor="end" font-family="Arial" font-size="12" fill="#6b7280">€0</text><line x1="80" y1="348.0" x2="760" y2="348.0"/><text x="70" y="353.0" text-anchor="end" font-family="Arial" font-size="12" fill="#6b7280">€1,000</text><line x1="80" y1="276.0" x2="760" y2="276.0"/><text x="70" y="281.0" text-anchor="end" font-family="Arial" font-size="12" fill="#6b7280">€2,000</text><line x1="80" y1="204.0" x2="760" y2="204.0"/><text x="70" y="209.0" text-anchor="end" font-family="Arial" font-size="12" fill="#6b7280">€3,000</text><line x1="80" y1="132.0" x2="760" y2="132.0"/><text x="70" y="137.0" text-anchor="end" font-family="Arial" font-size="12" fill="#6b7280">€4,000</text><line x1="80" y1="60.0" x2="760" y2="60.0"/><text x="70" y="65.0" text-anchor="end" font-family="Arial" font-size="12" fill="#6b7280">€5,000</text></g>
            <defs>
                <linearGradient id="grad0" x1="0%" y1="0%" x2="0%" y2="100%">
                    <stop offset="0%" style="stop-color:#16a34a;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#16a34a;stop-opacity:0.7" />
                </linearGradient>
            </defs>
            
            <g>
                <rect x="100.4" y="110.39999999999998" width="95.19999999999999" height="309.6"
                      fill="url(#grad0)" rx="4" ry="4" filter="url(#shadow)">
                    <animate attributeName="height" from="0" to="309.6" dur="0.5s" begin="0.0s" fill="freeze"/>
                    <animate attributeName="y" from="420" to="110.39999999999998" dur="0.5s" begin="0.0s" fill="freeze"/>
                </rect>

                <!-- Value label on top of bar -->
                <text x="148.0" y="100.39999999999998" text-anchor="middle"
                      font-family="Arial" font-size="14" font-weight="bold" fill="#16a34a">
                    €4,300.00
                </text>

                <!-- Category label -->
                <text x="148.0" y="445"
                      text-anchor="middle" font-family="Arial" font-size="12" fill="#1f2937">
                    Total Vendas
                </text>

                <!-- Percentage of sales -->
                <text x="148.0" y="465"
                      text-anchor="middle" font-family="Arial" font-size="10" fill="#6b7280">
                    (100.0% vendas)
                </text>
            </g>
            
            <defs>
                <linearGradient id="grad1" x1="0%" y1="0%" x2="0%" y2="100%">
                    <stop offset="0%" style="stop-color:#dc2626;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#dc2626;stop-opacity:0.7" />
                </linearGradient>
            </defs>
            
            <g>
                <rect x="236.4" y="204.0" width="95.19999999999999" height="216.0"
                      fill="url(#grad1)" rx="4" ry="4" filter="url(#shadow)">
                    <animate attributeName="height" from="0" to="216.0" dur="0.5s" begin="0.1s" fill="freeze"/>
                    <animate attributeName="y" from="420" to="204.0" dur="0.5s" begin="0.1s" fill="freeze"/>
                </rect>

                <!-- Value label on top of bar -->
                <text x="284.0" y="194.0" text-anchor="middle"
                      font-family="Arial" font-size="14" font-weight="bold" fill="#dc2626">
                    €3,000.00
                </text>

                <!-- Category label -->
                <text x="284.0" y="445"
                      text-anchor="middle" font-family="Arial" font-size="12" fill="#1f2937">
                    Total Custos
                </text>

                <!-- Percentage of sales -->
                <text x="284.0" y="465"
                      text-anchor="middle" font-family="Arial" font-size="10" fill="#6b7280">
                    (69.8% vendas)
                </text>
            </g>
            
            <defs>
                <linearGradient id="grad2" x1="0%" y1="0%" x2="0%" y2="100%">
                    <stop offset="0%" style="stop-color:#2563eb;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#2563eb;stop-opacity:0.7" />
                </linearGradient>
            </defs>
            
            <g>
                <rect x="372.4" y="337.2" width="95.19999999999999" height="82.8"
                      fill="url(#grad2)" rx="4" ry="4" filter="url(#shadow)">
                    <animate attributeName="height" from="0" to="82.8" dur="0.5s" begin="0.2s" fill="freeze"/>
                    <animate attributeName="y" from="420" to="337.2" dur="0.5s" begin="0.2s" fill="freeze"/>
                </rect>

                <!-- Value label on top of bar -->
                <text x="420.0" y="327.2" text-anchor="middle"
                      font-family="Arial" font-size="14" font-weight="bold" fill="#2563eb">
                    €1,150.00
                </text>

                <!-- Category label -->
                <text x="420.0" y="445"
                      text-anchor="middle" font-family="Arial" font-size="12" fill="#1f2937">
                    Margem Compensada
                </text>

                <!-- Percentage of sales -->
                <text x="420.0" y="465"
                      text-anchor="middle" font-family="Arial" font-size="10" fill="#6b7280">
                    (26.7% vendas)
                </text>
            </g>
            
            <defs>
                <linearGradient id="grad3" x1="0%" y1="0%" x2="0%" y2="100%">
                    <stop offset="0%" style="stop-color:#7c3aed;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#7c3aed;stop-opacity:0.7" />
                </linearGradient>
            </defs>
            
            <g>
                <rect x="508.4" y="398.472" width="95.19999999999999" height="21.528"
                      fill="url(#grad3)" rx="4" ry="4" filter="url(#shadow)">
                    <animate attributeName="height" from="0" to="21.528" dur="0.5s" begin="0.30000000000000004s" fill="freeze"/>
                    <animate attributeName="y" from="420" to="398.472" dur="0.5s" begin="0.30000000000000004s" fill="freeze"/>
                </rect>

                <!-- Value label on top of bar -->
                <text x="556.0" y="388.472" text-anchor="middle"
                      font-family="Arial" font-size="14" font-weight="bold" fill="#7c3aed">
                    €299.00
                </text>

                <!-- Category label -->
                <text x="556.0" y="445"
                      text-anchor="middle" font-family="Arial" font-size="12" fill="#1f2937">
                    IVA s/ Margem
                </text>

                <!-- Percentage of sales -->
                <text x="556.0" y="465"
                      text-anchor="middle" font-family="Arial" font-size="10" fill="#6b7280">
                    (7.0% vendas)
                </text>
            </g>
            
            <defs>
                <linearGradient id="grad4" x1="0%" y1="0%" x2="0%" y2="100%">
                    <stop offset="0%" style="stop-color:#1e40af;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#1e40af;stop-opacity:0.7" />
                </linearGradient>
            </defs>
            
            <g>
                <rect x="644.4" y="347.928" width="95.19999999999999" height="72.072"
                      fill="url(#grad4)" rx="4" ry="4" filter="url(#shadow)">
                    <animate attributeName="height" from="0" to="72.072" dur="0.5s" begin="0.4s" fill="freeze"/>
                    <animate attributeName="y" from="420" to="347.928" dur="0.5s" begin="0.4s" fill="freeze"/>
                </rect>

                <!-- Value label on top of bar -->
                <text x="692.0" y="337.928" text-anchor="middle"
                      font-family="Arial" font-size="14" font-weight="bold" fill="#1e40af">
                    €1,001.00
                </text>

                <!-- Category label -->
                <text x="692.0" y="445"
                      text-anchor="middle" font-family="Arial" font-size="12" fill="#1f2937">
                    Margem Líquida
                </text>

                <!-- Percentage of sales -->
                <text x="692.0" y="465"
                      text-anchor="middle" font-family="Arial" font-size="10" fill="#6b7280">
                    (23.3% vendas)
                </text>
            </g>
            
            <line x1="80" y1="60" x2="80" y2="420"
                  stroke="#1f2937" stroke-width="2"/>
            <line x1="80" y1="420" x2="760" y2="420"
                  stroke="#1f2937" stroke-width="2"/>
        </svg>
        
                    </div>
                </div>

                <!-- Comparison and Distribution -->
                <div class="chart-grid">
                    <div class="section">
                        <div class="bookmark" id="comparison-analysis">Comparação de Regimes</div>
                        <div class="section-anchor" id="comparison-analysis"></div>
                        <div class="section-header">
                            <div class="section-icon" style="background: #dc2626;">⚖️</div>
                            <div>
                                <span class="section-number">7.</span>
                                <h2 class="section-title" style="margin: 0;">Comparação de Regimes Fiscais</h2>
                            </div>
                        </div>
                        <div class="chart-container">
                            <svg width="600" height="300" xmlns="http://www.w3.org/2000/svg">
            <rect width="600" height="300" fill="white"/>

            <text x="300.0" y="30" text-anchor="middle" font-family="Arial" font-size="16" font-weight="bold" fill="#1f2937">
                Comparação: IVA Normal vs IVA Margem
            </text>

            <!-- Normal VAT -->
            <g transform="translate(50, 70)">
                <text x="0" y="0" font-family="Arial" font-size="14" fill="#1f2937">IVA Regime Normal (23%)</text>
                <rect x="0" y="10" width="400.0" height="60"
                      fill="#dc2626" opacity="0.8" rx="4"/>
                <text x="410.0" y="45.0"
                      font-family="Arial" font-size="14" font-weight="bold" fill="#dc2626">
                    €989.00
                </text>
            </g>

            <!-- Margin VAT -->
            <g transform="translate(50, 150)">
                <text x="0" y="0" font-family="Arial" font-size="14" fill="#1f2937">IVA Regime Margem</text>
                <rect x="0" y="10" width="120.93023255813952" height="60"
                      fill="#16a34a" opacity="0.8" rx="4"/>
                <text x="130.93023255813952" y="45.0"
                      font-family="Arial" font-size="14" font-weight="bold" fill="#16a34a">
                    €299.00
                </text>
            </g>

            <!-- Savings -->
            <rect x="50" y="240" width="500" height="40" fill="#16a34a" opacity="0.1" rx="20"/>
            <text x="300.0" y="265" text-anchor="middle" font-family="Arial" font-size="16" font-weight="bold" fill="#16a34a">
                Poupança: €690.00 (69.8%)
            </text>
        </svg>
        
                        </div>
                    </div>

                    <div class="section">
                        <div class="section-header">
                            <div class="section-icon" style="background: #7c3aed;">🥧</div>
                            <div>
                                <span class="section-number">7.1</span>
                                <h2 class="section-title" style="margin: 0;">Distribuição de Valores</h2>
                            </div>
                        </div>
                        <div class="chart-container">
                            <svg width="400" height="400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 400">
            <defs>
                <filter id="pieShadow">
                    <feGaussianBlur in="SourceAlpha" stdDeviation="3"/>
                    <feOffset dx="0" dy="3" result="offsetblur"/>
                    <feComponentTransfer>
                        <feFuncA type="linear" slope="0.3"/>
                    </feComponentTransfer>
                    <feMerge>
                        <feMergeNode/>
                        <feMergeNode in="SourceGraphic"/>
                    </feMerge>
                </filter>
            </defs>

            <!-- Background circle -->
            <circle cx="200.0" cy="200.0" r="130" fill="#f3f4f6" opacity="0.3"/>

            <!-- Title -->
            <text x="200.0" y="30" text-anchor="middle" font-family="Arial" font-size="16" font-weight="bold" fill="#1f2937">Distribuição de Valores</text>
        
            <defs>
                <radialGradient id="pieGrad0">
                    <stop offset="0%" style="stop-color:#dc2626;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#dc2626;stop-opacity:0.7" />
                </radialGradient>
            </defs>
            
            <path d="M 200.0 200.0 L 200.0 80.0 A 120 120 0 1 1 86.42722722108687 238.74564857257354 Z"
                  fill="url(#pieGrad0)" stroke="white" stroke-width="2" filter="url(#pieShadow)">
                <animate attributeName="opacity" from="0" to="1" dur="0.5s" begin="0.0s" fill="freeze"/>
            </path>
            
            <line x1="278.07581511061426"
                  y1="255.85845589356347"
                  x2="313.8605637029791" y2="281.46024817811343"
                  stroke="#dc2626" stroke-width="1" opacity="0.5"/>

            <text x="346.39215333240173" y="299.73460480043155" text-anchor="middle"
                  font-family="Arial" font-size="12" font-weight="bold" fill="#dc2626">
                Custos Diretos
            </text>
            <text x="346.39215333240173" y="314.73460480043155" text-anchor="middle"
                  font-family="Arial" font-size="11" fill="#6b7280">
                €3,000.00
            </text>
            <text x="346.39215333240173" y="329.73460480043155" text-anchor="middle"
                  font-family="Arial" font-size="10" fill="#1f2937">
                (69.8%)
            </text>
            
            <defs>
                <radialGradient id="pieGrad1">
                    <stop offset="0%" style="stop-color:#7c3aed;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#7c3aed;stop-opacity:0.7" />
                </radialGradient>
            </defs>
            
            <path d="M 200.0 200.0 L 86.42722722108687 238.74564857257354 A 120 120 0 0 1 80.70083265444256 187.04976175289892 Z"
                  fill="url(#pieGrad1)" stroke="white" stroke-width="2" filter="url(#pieShadow)">
                <animate attributeName="opacity" from="0" to="1" dur="0.5s" begin="0.2s" fill="freeze"/>
            </path>
            
            <line x1="104.5836029090114"
                  y1="210.56935031942746"
                  x2="60.85108757564163" y2="215.4136358824984"
                  stroke="#7c3aed" stroke-width="1" opacity="0.5"/>

            <text x="21.094255454396375" y="214.81753184892648" text-anchor="middle"
                  font-family="Arial" font-size="12" font-weight="bold" fill="#7c3aed">
                IVA a Pagar
            </text>
            <text x="21.094255454396375" y="229.81753184892648" text-anchor="middle"
                  font-family="Arial" font-size="11" fill="#6b7280">
                €299.00
            </text>
            <text x="21.094255454396375" y="244.81753184892648" text-anchor="middle"
                  font-family="Arial" font-size="10" fill="#1f2937">
                (7.0%)
            </text>
            
            <defs>
                <radialGradient id="pieGrad2">
                    <stop offset="0%" style="stop-color:#16a34a;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#16a34a;stop-opacity:0.7" />
                </radialGradient>
            </defs>
            
            <path d="M 200.0 200.0 L 80.70083265444256 187.04976175289892 A 120 120 0 0 1 199.99999999999997 80.0 Z"
                  fill="url(#pieGrad2)" stroke="white" stroke-width="2" filter="url(#pieShadow)">
                <animate attributeName="opacity" from="0" to="1" dur="0.5s" begin="0.4s" fill="freeze"/>
            </path>
            
            <line x1="135.88517448115988"
                  y1="128.54869386296227"
                  x2="106.49921278502482" y2="95.8001785501533"
                  stroke="#16a34a" stroke-width="1" opacity="0.5"/>

            <text x="79.78470215217477" y="61.02880099305423" text-anchor="middle"
                  font-family="Arial" font-size="12" font-weight="bold" fill="#16a34a">
                Margem Líquida
            </text>
            <text x="79.78470215217477" y="76.02880099305423" text-anchor="middle"
                  font-family="Arial" font-size="11" fill="#6b7280">
                €1,001.00
            </text>
            <text x="79.78470215217477" y="91.02880099305423" text-anchor="middle"
                  font-family="Arial" font-size="10" fill="#1f2937">
                (23.3%)
            </text>
            
            <circle cx="200.0" cy="200.0" r="40" fill="white" opacity="0.9"/>
            <text x="200.0" y="195.0" text-anchor="middle"
                  font-family="Arial" font-size="14" font-weight="bold" fill="#1f2937">
                Total
            </text>
            <text x="200.0" y="215.0" text-anchor="middle"
                  font-family="Arial" font-size="12" fill="#6b7280">
                €4,300.00
            </text>
        </svg>
        
                        </div>
                    </div>
                </div>

                <!-- Savings Highlight -->
                <div class="highlight-box">
                    <div class="bookmark" id="savings-analysis">Análise de Poupança</div>
                    <div class="section-anchor" id="savings-analysis"></div>

                    <div class="call-out success">
                        <h4><span class="call-out-icon">💰</span> Análise de Poupança Fiscal - Seção 8</h4>
                        <p style="font-size: 1.1em; margin-bottom: 16px;">
                            <strong>Vantagem Significativa do Regime de Margem:</strong> A aplicação do Artigo 308º do CIVA
                            resulta numa poupança fiscal substancial para a sua empresa.
                        </p>
                    </div>

                    <h3>💰 Análise de Poupança Fiscal</h3>
                    <p style="font-size: 1.1em; margin-bottom: 12px;">
                        Ao utilizar o <strong>Regime de IVA sobre Margem</strong>, a sua empresa obtém uma poupança significativa:
                    </p>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px;">
                        <div>
                            <div style="font-size: 0.9em; color: #6b7280;">IVA no Regime Normal</div>
                            <div style="font-size: 1.5em; font-weight: 700; color: #dc2626;">€989.00</div>
                        </div>
                        <div>
                            <div style="font-size: 0.9em; color: #6b7280;">IVA no Regime Margem</div>
                            <div style="font-size: 1.5em; font-weight: 700; color: #16a34a;">€299.00</div>
                        </div>
                        <div>
                            <div style="font-size: 0.9em; color: #6b7280;">Poupança Total</div>
                            <div style="font-size: 1.5em; font-weight: 700; color: #16a34a;">€690.00</div>
                        </div>
                        <div>
                            <div style="font-size: 0.9em; color: #6b7280;">Redução Percentual</div>
                            <div style="font-size: 1.5em; font-weight: 700; color: #16a34a;">69.8%</div>
                        </div>
                    </div>
                </div>

                <!-- Detailed Results Table -->
                <div class="section page-break">
                    <div class="bookmark" id="detailed-results">Análise Detalhada</div>
                    <div class="section-anchor" id="detailed-results"></div>
                    <div class="section-header">
                        <div class="section-icon" style="background: #059669;">📋</div>
                        <div>
                            <span class="section-number">9.</span>
                            <h2 class="section-title" style="margin: 0;">Análise Detalhada por Documento</h2>
                        </div>
                    </div>
                    <div class="call-out info">
                        <h4><span class="call-out-icon">ℹ️</span> Resumo de Documentos</h4>
                        <p>
                            Apresentamos os primeiros 2 documentos de um total de <strong>2 processados</strong>.
                            Para a lista completa com todos os detalhes, consulte o <strong>ficheiro Excel exportado</strong> que acompanha este relatório.
                        </p>
                    </div>

                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Documento</th>
                                <th>Data</th>
                                <th>Cliente</th>
                                <th class="value">Venda (€)</th>
                                <th class="value">Custos (€)</th>
                                <th class="value">Margem (€)</th>
                                <th class="value">IVA (€)</th>
                                <th class="value">Margem %</th>
                            </tr>
                        </thead>
                        <tbody>
        
                <tr style="background: #f9fafb;">
                    <td><strong>FT 2025/001</strong></td>
                    <td>2025-01-15</td>
                    <td>Hotel Sol & Mar Lda</td>
                    <td class="value">2,500.00</td>
                    <td class="value">1,900.00</td>
                    <td class="value" style="color: #16a34a;">
                        600.00
                    </td>
                    <td class="value">138.00</td>
                    <td class="value">
                        <span class="badge badge-success">
                            24.0%
                        </span>
                    </td>
                </tr>
            
                <tr >
                    <td><strong>FT 2025/002</strong></td>
                    <td>2025-01-20</td>
                    <td>Turismo Verde SA</td>
                    <td class="value">1,800.00</td>
                    <td class="value">1,100.00</td>
                    <td class="value" style="color: #16a34a;">
                        700.00
                    </td>
                    <td class="value">161.00</td>
                    <td class="value">
                        <span class="badge badge-success">
                            38.9%
                        </span>
                    </td>
                </tr>
            
                        </tbody>
                    </table>
                </div>

                <!-- Critical Information Highlights -->
                <div class="call-out critical">
                    <h4><span class="call-out-icon">⚠️</span> Informações Críticas</h4>
                    <div style="display: grid; gap: 12px; margin-top: 16px;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="color: #dc2626; font-weight: 700;">•</span>
                            <span><strong>Validação ROC/TOC obrigatória</strong> antes de submissão fiscal</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="color: #dc2626; font-weight: 700;">•</span>
                            <span>Este documento tem <strong>caráter puramente informativo</strong></span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="color: #dc2626; font-weight: 700;">•</span>
                            <span>Cálculos baseados no <strong>Art. 308º do CIVA</strong> - Regime Margem</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="color: #dc2626; font-weight: 700;">•</span>
                            <span>Poupança fiscal: <strong>€690.00</strong> vs regime normal</span>
                        </div>
                    </div>
                </div>

                <div class="call-out success">
                    <h4><span class="call-out-icon">✅</span> Certificação de Conformidade</h4>
                    <p style="text-align: center; font-size: 1.1em; margin: 16px 0;">
                        <strong>Sistema Certificado:</strong> Todos os cálculos seguem rigorosamente as disposições legais<br>
                        do Código do IVA e orientações da Autoridade Tributária para o setor do turismo.<br><br>
                        <span class="compliance-badge" style="font-size: 1em; padding: 12px 20px;">
                            ✅ Conforme Art. 308º CIVA - Regime Especial de Tributação da Margem
                        </span>
                    </p>
                </div>

                <!-- Enhanced Footer -->
                <div style="background: linear-gradient(135deg, #1f2937 0%, #374151 100%); color: white; padding: 40px; border-radius: 12px; margin-top: 40px; text-align: center;">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 32px; margin-bottom: 32px;">
                        <div>
                            <h4 style="color: #e5e7eb; margin-bottom: 16px; font-size: 1.1em;">📊 Sistema</h4>
                            <p style="color: #d1d5db; font-size: 0.9em; line-height: 1.5;">
                                <strong>IVA Margem Pro v1.2.5</strong><br>
                                Sistema Profissional de Cálculo<br>
                                Com Conformidade Legal Total
                            </p>
                        </div>

                        <div>
                            <h4 style="color: #e5e7eb; margin-bottom: 16px; font-size: 1.1em;">🔒 Rastreabilidade</h4>
                            <p style="color: #d1d5db; font-size: 0.9em; line-height: 1.5; font-family: monospace;">
                                Hash: <span id="finalHash">Calculando...</span><br>
                                Timestamp: 2025-09-16T12:56:28.872974<br>
                                ID: 8D11DAF7
                            </p>
                        </div>

                        <div>
                            <h4 style="color: #e5e7eb; margin-bottom: 16px; font-size: 1.1em;">⚖️ Disclaimer Legal</h4>
                            <p style="color: #d1d5db; font-size: 0.9em; line-height: 1.5;">
                                Documento informativo<br>
                                <strong style="color: #fbbf24;">Validação ROC/TOC obrigatória</strong><br>
                                Não substitui aconselhamento fiscal
                            </p>
                        </div>
                    </div>

                    <div style="border-top: 1px solid #4b5563; padding-top: 20px; color: #9ca3af; font-size: 0.85em;">
                        <p>
                            Relatório gerado em <strong>16/09/2025 às 12:56:28</strong><br>
                            © 2025 IVA Margem Pro - Todos os direitos reservados
                        </p>
                    </div>
                </div>
            </div>

            <script>
                // Enhanced Navigation and PDF functionality
                document.addEventListener('DOMContentLoaded', function() {
                    // Calculate and display report hash
                    const content = document.documentElement.outerHTML;
                    const encoder = new TextEncoder();
                    const data = encoder.encode(content);

                    crypto.subtle.digest('SHA-256', data).then(hashBuffer => {
                        const hashArray = Array.from(new Uint8Array(hashBuffer));
                        const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
                        const reportHashEl = document.getElementById('reportHash');
                        const finalHashEl = document.getElementById('finalHash');

                        if (reportHashEl) reportHashEl.textContent = hashHex.substring(0, 32) + '...';
                        if (finalHashEl) finalHashEl.textContent = hashHex.substring(0, 16) + '...';
                    }).catch(err => {
                        console.log('Hash calculation not available in this environment');
                        const reportHashEl = document.getElementById('reportHash');
                        const finalHashEl = document.getElementById('finalHash');
                        if (reportHashEl) reportHashEl.textContent = 'Hash não disponível';
                        if (finalHashEl) finalHashEl.textContent = 'N/A';
                    });

                    // Enhanced smooth scroll with offset
                    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                        anchor.addEventListener('click', function (e) {
                            e.preventDefault();
                            const targetId = this.getAttribute('href').substring(1);
                            const targetElement = document.getElementById(targetId);

                            if (targetElement) {
                                // Calculate offset to account for fixed headers
                                const offset = 80;
                                const elementPosition = targetElement.getBoundingClientRect().top;
                                const offsetPosition = elementPosition + window.pageYOffset - offset;

                                window.scrollTo({
                                    top: offsetPosition,
                                    behavior: 'smooth'
                                });

                                // Highlight the target section temporarily
                                targetElement.style.transition = 'box-shadow 0.3s ease';
                                targetElement.style.boxShadow = '0 0 20px rgba(59, 130, 246, 0.3)';
                                setTimeout(() => {
                                    targetElement.style.boxShadow = '';
                                }, 2000);
                            }
                        });
                    });

                    // Add hover effects to TOC items
                    document.querySelectorAll('.toc-item').forEach(item => {
                        item.addEventListener('mouseenter', function() {
                            this.style.backgroundColor = 'rgba(255, 255, 255, 1)';
                            this.style.transform = 'translateX(4px)';
                            this.style.boxShadow = '0 2px 8px rgba(0, 0, 0, 0.1)';
                        });

                        item.addEventListener('mouseleave', function() {
                            this.style.backgroundColor = 'rgba(255, 255, 255, 0.8)';
                            this.style.transform = 'translateX(0)';
                            this.style.boxShadow = '';
                        });
                    });

                    // Add print preparation
                    window.addEventListener('beforeprint', function() {
                        // Expand all collapsed sections for printing
                        document.querySelectorAll('.collapsed').forEach(el => {
                            el.classList.remove('collapsed');
                        });

                        // Ensure all charts and images are visible
                        document.querySelectorAll('svg, img').forEach(el => {
                            el.style.pageBreakInside = 'avoid';
                        });
                    });

                    // Add keyboard navigation
                    document.addEventListener('keydown', function(e) {
                        // Ctrl+P for print
                        if (e.ctrlKey && e.key === 'p') {
                            e.preventDefault();
                            window.print();
                        }

                        // Ctrl+Home to go to top
                        if (e.ctrlKey && e.key === 'Home') {
                            e.preventDefault();
                            window.scrollTo({ top: 0, behavior: 'smooth' });
                        }
                    });

                    // Add section visibility tracking for better navigation
                    const observer = new IntersectionObserver((entries) => {
                        entries.forEach(entry => {
                            if (entry.isIntersecting) {
                                // Update active TOC item
                                const id = entry.target.id;
                                document.querySelectorAll('.toc-item').forEach(item => {
                                    item.classList.remove('active');
                                });

                                const activeItem = document.querySelector(`a[href="#${id}"] .toc-item`);
                                if (activeItem) {
                                    activeItem.classList.add('active');
                                    activeItem.style.backgroundColor = 'rgba(59, 130, 246, 0.1)';
                                    activeItem.style.borderLeftColor = '#1e40af';
                                }
                            }
                        });
                    }, { rootMargin: '-20% 0px -70% 0px' });

                    // Observe all sections with anchors
                    document.querySelectorAll('.section-anchor').forEach(section => {
                        observer.observe(section);
                    });

                    // Auto print dialog
                    if (window.location.search.includes('autoprint=true')) {
                        setTimeout(() => window.print(), 500);
                    }

                    // Add loading animation completion
                    setTimeout(() => {
                        document.body.classList.add('loaded');
                        // Animate metric cards
                        document.querySelectorAll('.metric-card, .summary-card').forEach((card, index) => {
                            setTimeout(() => {
                                card.style.transform = 'translateY(0)';
                                card.style.opacity = '1';
                            }, index * 100);
                        });
                    }, 100);

                    console.log('📊 IVA Margem Pro v1.2.5 - PDF Enhanced Navigation Loaded');
                });

                // Add CSS for active states and animations
                const style = document.createElement('style');
                style.textContent = `
                    .toc-item.active {
                        background-color: rgba(59, 130, 246, 0.1) !important;
                        border-left-color: #1e40af !important;
                        font-weight: 600;
                    }

                    .metric-card, .summary-card {
                        transform: translateY(20px);
                        opacity: 0;
                        transition: all 0.3s ease;
                    }

                    body.loaded .metric-card,
                    body.loaded .summary-card {
                        transform: translateY(0);
                        opacity: 1;
                    }

                    @keyframes pulse {
                        0% { opacity: 1; }
                        50% { opacity: 0.7; }
                        100% { opacity: 1; }
                    }

                    .compliance-badge {
                        animation: pulse 3s infinite;
                    }

                    /* Print optimizations */
                    @media print {
                        .toc-item:hover {
                            transform: none !important;
                            background: transparent !important;
                        }

                        .section-anchor {
                            page-break-before: auto;
                        }

                        .call-out {
                            page-break-inside: avoid;
                        }

                        .chart-container {
                            page-break-inside: avoid;
                        }
                    }
                `;
                document.head.appendChild(style);
            </script>
        </body>
        </html>
        